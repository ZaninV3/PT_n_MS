<!--
Тире - &mdash;
Прим равно \approx
Деление \frac{}{}
Пересечение \cap
Объединение \cup
Меньше или равно \leq
Больше или равно \geq
Принадлежность \in и \notin
Тильда \sim

-->
# Теория вероятности и математическая статистика
Вариант №4
## №1 Из партии, в которой 30 микросхем без дефекта и 5 с дефектами, берут наудачу 3 микросхемы. Найти вероятность того, что
### 1. Две микросхемы без дефекта;
### 2. По крайней мере одна микросхема без дефекта.

#### Решение

__№1__ 2 без, 1 с

Всего в партии $30 + 5 = 35$ микросхем.

Число способов выбрать 2 микросхемы без дефекта из 30:

$$C(30, 2) = \frac{30!}{2! * (30-2)!} = \frac{30 - 29}{2} = 435$$

Число способов выбрать 1 микросхему с дефектом из 5 &mdash; $5$

Общее число благоприятных исходов $C(30,2) * C(5,1) = 2175$

Общее число способов выбрать 3 микросхемы из 35:

$$C(35, 3) = \frac{35!}{3! * (35 - 3)!} = \frac{35 * 34 * 33}{6} = 6545$$

Вероятность

$$P = \frac{C(30, 2) * C(5, 1)}{C(35, 3)} \approx 0,3323$$

__№2__ 1, либо 2, либо 3 без

Рассматриваем все варианты, кроме одного &mdash; все с дефектами.

$$C(5, 3) \frac{5!}{3! * (5 - 3)!} = \frac{5 * 4}{2} = 10$$

Вероятность исключительного случая

$$Pu = \frac{C(5, 3)}{C(35, 3)} \approx 0,0002$$

Вероятность

$$P = 1 - 0,0002 = 0,9998$$



## №2 По самолету производится 3 выстрела. Пусть событие $A_i(i = 1, 2, 3)$ - попадание при i-м выстреле. Вероятность $P(A_1) = 0,5$, $P(A_2) = 0,6$, $P(A_3) = 0,8$. Событие $B$ состоит в том, что при третьем выстреле будет попадание; Событие $C$ - самолет будет сбит, если для этого достаточно двух попаданий.
### Написать формулу выражающую события $B$ и $C$ через события $A_i(i = 1, 2, 3)$ и вычислить вероятность этих событий

#### Решение

__Событие B__ не зависит от первых двух выстрелов, соответственно $P(B) = P(A_3) = 0,8$

__Событие C__

Самолет будет сбит, если произойдет хотя бы два попадания из трех выстрелов. То есть событие $C$:

$$C = \overline{(A_1 \cap \overline{A_2} \cap \overline{A_3}) \cup (\overline{A_1} \cap A_2 \cap \overline{A_3}) \cup (\overline{A_1} \cap \overline{A_2} \cap A_3)} \cup \overline{zero}$$

Рассмотрим случаи, когда самолет был не сбит и по самолету было 1 попадание.

1. Все промахи:

$$P(zero) = P(\overline{A_1} \cap \overline{A_2} \cap \overline{A_3}) = 0,5 * 0,4 * 0,2 = 0.04$$

2. Только 1 попадание:

$$A_1 \cap \overline{A_2} \cap \overline{A_3} = 0,5 * 0,4 * 0,2 = 0.04$$

$$\overline{A_1} \cap A_2 \cap \overline{A_3} = 0,5 * 0,6 * 0,2 = 0.06$$

$$\overline{A_1} \cap \overline{A_2} \cap A_3 = 0,5 * 0,4 * 0,8 = 0.16$$

Вероятность

$$P(C) = 1 - (0,04 + 0,06 + 0,16) - 0,04 = 0,7$$



## №3 Вероятность брака детали равна $0,05$. После изготовления деталь осматривается контролером, который обнаруживает брак с вероятностью $0,95$. Найти вероятность того, что из $100$ проверенных деталей забракованных окажется не более одной
### 1. Вычислить эту вероятность с помощью формулы Бернулли
### 2. Эту же вероятность с помощью формулы Пуассона

#### Решение

##### Формула Бернулли

Формула Бернулли применяется для вычисления вероятности того, что в $n$ независимых испытаниях событие произойдет ровно $k$ раз:

$$P(k) = C(n, k) * p^k * (1 - p)^{n - k}$$

Нужно найти вероятность $P(\leq 1)$

$$P(\leq 1) = P(0) + P(1)$$

$$P(0) = C(100, 0) * 0,05^0 * 0,95^{100} = 0,95^{100} \approx 0,0059$$

$$P(1) = C(100, 1) * 0,05^1 * 0,95^{99} \approx 0,0312$$

Вероятность

$$P(\leq 1) = 0,0059 + 0,0062 = 0,0371$$

##### Формула Пуассона

$$P(k) = \frac{\lambda ^ k * e ^{-\lambda}}{k!}$$

где $\lambda = n * p$ &mdash; среднее число успехов

$$\lambda = 100 * 0,05 = 5$$

Нужно найти вероятность $P(\leq 1)$

$$P(\leq 1) = P(0) + P(1)$$

$$P(0) = \frac{5 ^ 0 * e ^{-5}}{0!} = e ^{-5} \approx 0,0067$$

$$P(1) = \frac{5 ^ 1 * e ^{-5}}{1!} \approx 5 * 0,0067 = 0,0337$$

$$P(\leq 1) = 0,0067 + 0,0337 = 0,0404$$



## №4 СВ X задана законом распределения.
| $x_i$ | $30$  | $40$ | $50$  |  $60$ |  $70$ |
| ----- | ----- | ---- | ----- | ----- | ----- |
| $p_i$ | $0,1$ | $?$  | $0,1$ | $0,2$ | $0,4$ |

## Найти:
### 1. Числовые характеристики $M[X]$, $D[X]$;
### 2. Функцию распределения $F(x)$ и построить ее график;
### 3. Вероятность $P(x_2 \leq X \leq x_4)$;
### 4. Закон распределения величины СВ $Y = 6 - 3X$;
### 5. $M[Y]$, $D[Y]$ дважды, используя свойства (по результатам предыдущих пунктов) и непосредственно составленный закон распределения.

#### Решение

Найдем неизвестную вероятность

$$p_2 = 1 - (0,1 + 0,1 + 0,2 + 0,4) = 0,2$$

##### Числовые характеристики $M[X]$, $D[X]$

Мат ожидание:

$$M[X] = \sum x_i * p_i = 56$$

Дисперсия:

$$D[X] = M[X^2] - M^2[X]$$

$$M[X^2] = \sum x_i^2 * p_i = 3259$$

$$D[X] = 3259 - 56^2 = 123$$

##### Функция распределения $F(x)$ и ее график

$$F(x) = P(X \leq x)$$

* При $x < 30: F(x) = 0$;
* При $30 \leq x < 40: F(x) = 0,1$;
* При $40 \leq x < 50: F(x) = 0,1 + 0,2 = 0,3$;
* При $50 \leq x < 60: F(x) = 0,3 + 0,1 = 0,4$;
* При $60 \leq x < 70: F(x) = 0,4 + 0,2 = 0,6$;
* При $x \geq 70: F(x) = 0,6 + 0,4 = 1$.

См. график [schedule_5.py](../../blob/main/schedule_5.py).

##### Вероятность $P(x_2 \leq X \leq x_4)$

$$P(40 \leq X \leq 60) = P(40) + P(50) + P(60) = 0,2 + 0,1 + 0,2 = 0,5$$

##### Закон распределения величины СВ $Y = 6 - 3X$

* $x = 30 => y = 6 - 90 = -84$;
* $x = 40 => y = 6 - 120 = -114$;
* $x = 50 => y = 6 - 150 = -144$;
* $x = 60 => y = 6 - 180 = -174$;
* $x = 70 => y = 6 - 210 = -204$;

Закон распределения $Y$:

| $y_i$ | $-84$ | $-114$ | $-144$ | $-174$ | $-204$ |
| ----- | ----- | ------ | ------ | ------ | ------ |
| $p_i$ | $0,1$ |   $?$  | $0,1$  |  $0,2$ | $0,4$  |

##### По свойствам и закону распределения числовые характеристики $M[Y]$, $D[Y]$

###### По свойствам

$$M[Y] = 6 - 3M[X] = 6 - 3 * 56 = -162$$

Вспомним свойства дисперсии:

* $D[const] = 0$
* Если $Y = aX + b$, где $a$ и $b$ &mdash; $const$: $D[Y] = D[aX + b] = a^2 * D[X]$. 
Значит: 

$$D[Y] = D[6 - 3X] = (-3)^2 * D[X] = 9 * 123 = 1107$$

###### По закону распределения

$$M[Y] = \sum y_i * p_i = -162$$

$$M[Y^2] = \sum y_i^2 * p_i = 28080$$

$$D[Y] = 28080 - (-162)^2 = 1836$$



## №5 Дана плотность вероятности непрерывной СВ $X$:

$$f(x) = \begin{cases}
C(2 - x), x \in [0;2]\\
0, x \notin [0;2]
\end{cases}$$

## Найти:
### 1. Параметр $C$ и построить график $f(x)$;
### 2. Интегральную функцию $F(x)$ и построить ее график;
### 3. Математическое ожидание $M[X]$, дисперсию $D[X]$ и среднее квадратическое оклонение $\sigma[X]$;
### 4. Вероятность $P(X > 1)$ дважды, используя дифференциальную и интегральную функции. Результат проиллюстрируйте на графиках.

#### Решение

##### Найти параметр $C$ и построить график $f(x)$

__Условие нормировки__: Полная вероятность по всем возможным значениям должна равняться $1$.
Условие нормировки плотности вероятности:

$$\int_{-\infty}^{+\infty} f(x) \, dx = 1$$

Поскольку у нас отрезок $[0; 2]$, то

$$\int_{0}^{2} C(2 - x) \, dx = 1$$

Решаем интеграл

$$С\int_{0}^{2} (2 - x) \, dx = С [2x - \frac{x^{2}}{2}]_{0}^{2} = C((4 - 2)-(0 - 0)) = 2C$$

Имеем уравение $2C = 1$, отсюда $C = 0.5$

См. график [task_5_1.py](../../blob/main/task_5_1.py).

##### Найти интегральную функцию $F(x)$ и построить график

Формула интегральной функции $F(x)$

$$F(x) = P(X \leq x) = \int_{-\infty}^{x} f(t) \, dt$$

* Для $x < 0$:

$$F(x) = \int_{-\infty}^{x} 0 \, dt = 0$$

* Для $0 \leq x \leq 2$

$$F(x) = \int_{-\infty}^{x} 0 \, dt + \int_{-\infty}^{x} \frac{1}{2}(2 - t) \, dt = 0 + \frac{1}{2}[2t - \frac{t^{2}}{2}]_{0}^{x} = \frac{1}{2}(2x - \frac{x^{2}}{2}) = x - \frac{x^{2}}{4}$$

* Для $x > 2$

$$F(x) = \int_{-\infty}^{x} 0 \, dt + \int_{0}^{2} \frac{1}{2}(2 - t) \, dt + \int_{2}^{x} 0 \, dt = 0 + \frac{1}{2}[2t - \frac{t^{2}}{2}]_{0}^{2} + 0 = (2 - 1) - 0 = 1$$

$$F(x) = \begin{cases}
0, x < 0\\
x - \frac{x^{2}}{4}, 0 \leq x \leq 2\\
1, x \geq 2
\end{cases}$$

См. график [task_5_2.py](../../blob/main/task_5_2.py).

##### Найти математическое ожидание $M[X]$, дисперсию $D[X]$ и среднее квадратическое оклонение $\sigma[X]$ 

###### $M[X]$

Матожидание:


$$M[X] = \int_{-\infty}^{+\infty} x f(x) \, dx = \int_{0}^{2} 0.5x(2 - x) \, dx$$

$$\int_{0}^{2} 0.5x(2 - x) \, dx = 0.5 \int_{0}^{2} (2x - x^2) \, dx = 0.5 [x^{2} - \frac{x^{3}}{3}]_{0}^{2} = 0.5((4 - \frac{8}{3}) - 0) = \frac{1}{2} * \frac{4}{3} = \frac{2}{3}$$

###### $D[X]$

Дисперсия:

$$D[X] = M[X^2] - M^2[X]$$

$$M[X^{2}] = \int_{-\infty}^{+\infty} x^{2}f(x) \, dx = \int_{0}^{2} 0.5 x^{2} (2 - x)\, dx = 0.5 \int_{0}^{2} (2x^{2} - x^3) dx = 0.5 [\frac{2x^{3}}{3} - \frac{x^{4}}{4}]_{0}^{2} = $$
$$ = 0.5((\frac{16}{3} - \frac{16}{4}) - 0) = 0.5 * \frac{4}{3} = \frac{2}{3}$$
$$D[X] = \frac{2}{3} - (\frac{2}{3})^{2} = \frac{2}{9}$$

###### $\sigma[X]$

Известно, что

$$D[X] = \sigma^{2}[X] \, => \sigma[X] = \sqrt{D[X]} \text{ , при } D[X] \geq 0$$

Значит среднее квадратическое отклонение:

$$\sigma[X] = \sqrt{\frac{2}{9}} = \frac{\sqrt{2}}{3}$$

См. график [task_5_3.py](../../blob/main/task_5_3.py).

##### $P(x > 1)$

###### Через плотность вероятности (дифференциальная функция)

$$P(X > 1) = \int_{2}^{1} f(x) \, dx = \int_{2}^{1} 0.5(2 - x) \, dx = 0.5[2x - \frac{x^{2}}{2}]_{1}^{2} = 0.5((4 - 2) - (2 - 0.5)) = 0.25$$

###### Через $F(x)$ (интегральная функция)

$F(x)$ найден ранее

$$F(x) = \begin{cases}
0, x < 0\\
x - \frac{x^{2}}{4}, 0 \leq x \leq 2\\
1, x \geq 2
\end{cases}$$

$$P(X > 1) = 1 - P(X \leq 1) = 1 - F(1)$$

$$F(1) = \int_{-\infty}^{1} f(x)\, dx = \int_{0}^{1} 0.5(2 - x) \, dx = 0.5 [2x - \frac{x^{2}}{2}]_{0}^{1} = 0.5((2 - 0.5) - 0) = 0.5 * 1.5 = 0.75$$

$$P(X > 1) = 1 - 0.75 = 0.25$$

См. график [task_5_4.py](../../blob/main/task_5_4.py).



## №6 Заданы математическое ожидание $a = 12$ и среднее квадратичное отклонение $\sigma = 5$ нормально распределенной непрерывной СВ. Известны:
### $\alpha = 12, \beta = 22, \delta = 10, \gamma = 0,8064$
### Найти:
### 1. Вероятность $P(\alpha < x < \beta)$;
### 2. Вероятность $P(|x - a| < \beta)$;
### 3. Симметричный, относительно $a$, интервал, в который попадает случайная величина $X$ с вероятностью $\gamma$;
### 4. Интервал, в котором окажутся практически все значения величины $X$.
### Дайте графические пояснения ответов на кривой нормального распределения к каждому пункту.

#### Решение

##### Вероятность $P(\alpha < x < \beta)$

$$P(\alpha < x < \beta) = P(12 < x < 22)$$

Нормальное распределение $X$ распределено как $N(\alpha, \sigma^{2})$

###### Стандартная нормальная величина $Z$

$$Z = \frac{X - \alpha}{\sigma} = \frac{X - 12}{5}$$

$$M[Z] = M[\frac{X - \alpha}{\sigma}] = \frac{M[X] - \alpha}{\sigma} = \frac{\alpha - \alpha}{\sigma} = 0;$$

$$D[Z] = D[\frac{X - \alpha}{\sigma}] = \frac{D[X]}{\sigma^{2}} = \frac{\sigma^{2}}{\sigma^{2}} = 1;$$

$$=> Z \sim N(0, 1)$$

Границы интервала в стандартных единицах:

$$z_{1} = \frac{12 - 12}{5} = 0 ; \, z_{2} = \frac{22 - 12}{5} = 2$$

Вычисление вероятности

По функции стандартного нормального распределения $Ф(z)$:

$$P(12 < x < 22) = Ф(2) - Ф(0)$$

Значения $Ф(2)$ и $Ф(0)$ можно найти в [таблице](https://mse.msu.ru/wp-content/uploads/2020/02/%D0%A2%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D1%8B.pdf).

$$Ф(2) = 0.9772$$

$$Ф(0) = 0.5$$

$$P(12 < x < 22) = 0.4772$$

См. график [task_6_1.py](../../blob/main/task_6_1.py).

##### Вероятность $P(|x - a| < \beta)$

$$|X - 12| < 22 <=> -22 < X - 12 < 22$$

$$-22 + 12 < X < 22 + 12$$

$$-10 < X < 34$$

<br><br>

$$Z = \frac{X - \alpha}{\sigma} = \frac{X - 12}{5}$$

$$z_1 = \frac{-10 - 12}{5} = -4.4$$

$$z_1 = \frac{34 - 12}{5} = 4.4$$

<br><br>

$$P(-4.4 < Z < 4.4) = Ф(4.4) - Ф(-4.4)$$

Значения $Ф(4.4)$ и $Ф(-4.4)$ можно найти в [таблице](https://mse.msu.ru/wp-content/uploads/2020/02/%D0%A2%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D1%8B.pdf).

$$Ф(4.4) \approx 0.9998$$

$$Ф(-4.4) = 1 - Ф(4.4) = 0.0002$$

$$P(-4.4 < Z < 4.4) = 0.9998 + 0.0002 = 1$$

См. график [task_6_2.py](../../blob/main/task_6_2.py).

##### Симметричный, относительно $a$, интервал, в который попадает случайная величина $X$ с вероятностью $\gamma$;

## TODO реализация



## №7 В результате опыта получена выборочная совокупность:

| $21$ | $13$ | $28$ | $19$ | $20$ | $14$ | $24$ | $23$ | $18$ | $15$ | $32$ | $14$ | $15$ | $20$ | $16$ | $17$ | $14$ | $22$ | $21$ | $24$ |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
|  $7$ | $22$ | $17$ | $17$ | $26$ | $22$ | $21$ | $21$ | $14$ | $23$ | $24$ | $18$ | $25$ | $18$ | $20$ | $21$ | $20$ | $22$ |  $7$ | $31$ |
| $18$ | $14$ | $22$ | $17$ |  $5$ | $20$ | $20$ | $11$ | $17$ | $19$ | $19$ |  $3$ | $15$ | $16$ | $19$ |  $7$ | $25$ | $13$ | $20$ | $15$ |
| $16$ | $12$ | $19$ | $16$ | $16$ | $22$ | $21$ |  $7$ | $14$ | $21$ | $20$ | $26$ | $17$ | $14$ | $14$ | $14$ | $10$ | $26$ | $12$ |  $9$ |
| $12$ | $11$ | $15$ | $19$ | $13$ | $15$ |  $2$ |  $6$ | $21$ |  $9$ | $23$ | $16$ | $16$ | $21$ | $11$ | $14$ | $19$ | $19$ | $28$ | $12$ |


### 1. По данной таблице составить интегральный вариационный ряд, разбив всю вариацию на 8-10 интервалов;
### 2. По сгруппированным данным построить:
### a. Полигон относительных частот;
### b. Гистограмму относительных частот;
### c. График эмпирической функции распределения.
### 3. Найти числовые характеристики выборочной совокупности: $M_о^*, M_е^*, \overline{x_в}, \sigma_в, s$;
### 4. Построить:
### a. На чертеже гистограммы ее теоретический аналог $f(x)$;
### b. На чертеже эмпирической функции $F*(x)$ ее теоретический аналог $F(x)$.
### 5. По виду гистограммы и эмпирической функции распределения выборки выдвинуть гипотезу о распределении генеральной совокупности;
### 6. Проверить выполнение правила "трех сигм";
### 7. Применить критерий Пирсона $\chi^2$ с заданным уровнем значимости $\alpha = 0,025$, окончательно принять или опровергнуть выдвинутую гипотезу о респределения генеральной совокупности;
### 8. Построить на одном чертеже:
### a. Полигон относительных частот $p_i^*$ и кривую распределения $p_i$. Сравнить график $p_i$ с графиком идеально нормально распределения;
### b. Гистограмму теоретических вероятностей (относительных частот) $p_i$ и график $f(x)$.
### 9. Найти доверительные интегралы для генеральной средней и генерального среднего квадратического отклонения по уровню надежности $\gamma = 0,99$

## TODO реализация
